

# ログイン機能

<br>

## 実装内容

<br>

* ログイン画面(index.php)からemailとpasswordを入力してuserテーブルに一致するレコードがあるとユーザー検索画面(welcome.php)にusernameを表示。


	* emailもしくはパスワードを間違えるとエラーメッセージが表示される。
	* CSRF攻撃を受けた場合エラーメッセージが表示される。
	* ログイン情報を記録しますかのボックスにチェックを入れるとDBとCOOKIEにトークンが保存され、自動ログインができる。
<br>

* ログイン済みの場合ユーザー検索画面(welcome.php)に遷移してユーザー名が表示される。

	* セッションにあるユーザー情報とDBのユーザー情報が合わなかったらログイン画面にリダイレクトしてエラーメッセージを表示する。
	* COOKIEの有効期限が切れていた場合ログイン画面にリダイレクトする。
	* COOKIEのトークンとDBのトークンが合わなかったらクッキーを削除してログイン画面にリダイレクトしてエラーメッセージを表示する。
<br>

* ログイン画面のログアウトボタンを押すとログアウトページ(logout.php)でSESSION、COOKIE共に削除される。

<br>

* ログイン画面の新規登録画面を押して名前、メールアドレス、パスワードを入力するとuserテーブルに保存される。

	* ユーザーのセッション情報、もしくはCOOKIE情報がある場合はユーザー検索画面にリダイレクトする。

<br>

* ユーザー検索画面(welcome.php)のフォームに入力して検索ボタンを押すと検索結果(search.php)が表示される。


	* 空の文字列を入力するとエラーメッセージが表示される。
	* 存在しない名前を入力するとエラーメッセージが表示される。

<br>
<br>

## DB設計

<br>

![スクリーンショット 2020-11-25 10 08 40](https://user-images.githubusercontent.com/68269509/100169286-72f68580-2f06-11eb-9acf-7817592be8fc.png)




